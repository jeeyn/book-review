## 제9장 추천 알고리즘: 알 수 없는 유튜브 알고리즘이 여기로 이끌다

```
< Discussion >

유튜브 영상의 70%, 넷플릭스 시청의 80%가 추천 알고리즘을 통해 이루어진다고 해서 생각보다 높은 수치에 놀랐습니다.

주로 알고리즘이 고른 것을 소비하고 있나요? 아니면 내가 선택한 것을 보고 있나요? 알고리즘이 추천한 것이 결국 나의 선택일까요?
```

#### 추천 서비스, 넷플릭스에서 유튜브까지

- 통계에 따르면 유튜브에서 사람들이 보는 영상 중 70%는 알고리즘이 추천한 영상이라고 한다. 즉, 추천 알고리즘은 유뷰브 서비스의 핵심
- 넷플릭스 프라이즈 이후에도 넷플릭스는 추천 알고리즘에 꾸준히 투자해왔고, 지금은 넷플릭스 시청의 80%가 추천을 거쳐 이뤄진다.
- 세계 최대 음원 스트리밍 서비스 스포티파이는 서비스 전체가 추천으로 구성되어있다. 고객이 팔로우한 아티스트나 감상한 노래, 장르 등을 바탕으로 플레이리스트를 자동으로 생성해주는 데일리믹스는 스포티파이의 핵심 기능이다.
  - 실제로 추천 시스템을 실험한 논문에 따르면 플레이리스트를 랜덤으로 했을 때에 비해 청취율이 40% 정도 더 높았다고 한다.
- 페이스북의 추천 알고리즘에는 개인화도 적용한다. 사람에 따라 행동의 가중치를 다르게 준다.
  - 만약 수줍음을 많이 타는 사람이 댓글보다 '좋아요'를 누르며 반응한다면 '좋아요'에 좀 더 높은 가중치를 부여하는 식
  - 휴대폰의 인터넷 속도가 느리다면 동영상을 적게 보여주는 알고리즘도 있다.
- 추천 시스템의 원조는 아마존이다. 아마존은 1990년대부터 이미 추천 상품으로 상당한 성과를 거두었고, 최근 아마존 제품 판매의 35%가 추천에서 발생한다.
- 추천 시스템의 핵심은 사용하면 할 수록 정교해진다는 데 있다. 데이터가 늘어나고 정보가 많아질수록 훨씬 더 정확한 추천이 가능하다.
- 사람들의 기호에는 강한 연관성이 있다. 이를 분석하는 것을 연관성 분석이라 하는데 상품관의 상관관계를 찾아내는 데 매우 유용하다. 아마존이 가장 먼저 적용한 분석 방식이기도 하다.

#### 맥주과 기저귀는 함께 팔린다

- 고객의 구매 내역을 분석하는 방식을 장바구니 분석, 또는 연관성 분석이라 한다. 이는 `데이터 마이닝`\*의 기반이 된다.
  > `데이터 마이닝(Data Mining)`  
  > 대규모 데이터에서 어떤 특정한 패턴을 발견하고 추출하여 데이터에서 의미 있는 핵심 가치를 발굴하는 행위
  - 1993년 IBM에서 근무하던 라케시 아그라왈 박사는 장바구니 분석을 처음 시도해 기념비적인 논문을 발표했고, 이는 데이터 관련 논문 중 가장 영향력 있는 논문으로 평가받으며 데이터 마이닝이라는 본격적인 학문의 시작을 알렸다.
- 연관성 분석에는 '신뢰도'라는 지표를 활용한다. 신뢰도 값이 높은 상품을 연관성이 높은 상품이라고 할 수 있다.
  > $$신뢰도(A→B) = \frac{구매 비율(A, B)}{구매 비율(A)}$$ > \* 구매 비율(A, B)는 A와 B를 함께 구매한 비율을 의미함
- 신뢰도에는 한 가지 맹점이 있다. 바나나가 원래 자주 판매되는 상품이라면 애초에 기저귀를 사는 고객이 바나나도 살 가능성이 높으므로 연관성을 정확히 판단하기 어렵다. 때문에 실제로는 연관성이 낮더라도 연관성이 높다고 잘못 판단할 수 있다.
- 두 상품의 판매 빈도까지 고려하는 '향상도' 지표가 있다.
  > $$향상도(A→B) = \frac{구매 비율(A, B)}{{구매 비율(A)} * {구매 비율(B)}}$$
  - 보통 향상도가 1보다 크면 함께 팔릴 가능성이 높다고 보고, 1보다 작으면 함께 팔릴 가능성이 낮다고 본다.

#### 추천 시스템의 시작

- 영상의 기본적인 추천 방식은 대체로 유사하다. 일반적으로 추천 시스템은 2가지 방식을 주로 활용한다.
  - 콘텐츠 기반 필터링(Content-Based Filtering) : 내가 선호하는 영상과 비슷한 영상을 추천하는 방식
  - 협업 필터링(Collaborative Filtering) : 나와 비슷한 고객이 시청한 영상을 추천하는 방식
- 콘텐츠 기반 필터링은 고객이 선호하는 특징에 기반해 유사한 영화를 추천한다.
  - 콘텐츠의 특징에 따라 영화를 추천하는 경우, 현재 고객이 선호하는 특징만 알면 되므로 영화의 특징만 추출할 수 있다면 아주 희귀한 영화도 추천 가능하다. 그러나 영화에서 특징을 규정하는 것이 쉽지 않다.

#### 협업 필터링, 비슷한 고객을 추천하다

- 콘텐츠 기반 필터링은 한계가 많다. 따라서 고객이 선호하는 영화 자체의 특징에 집중하기보다 범위를 더 확장하여 유사한 고객의 정보를 활용해볼 수 있다. 즉 고객의 관심사를 확장할 수 있는 것이다.
- 협업 필터링은 고객과 영화 사이의 관계에 중점을 둔다. 여러 고객이 영화에 점수를 매기고, 매겨진 점수의 유사성에 따라 영화 간의 유사성을 결정한다. 핵심은 고객 간의 유사도이다.

#### 행렬 인수분해, 잠재요인을 찾아내는 마법의 알고리즘

- 행렬 인수분해는 제각각인 평점 정보를 이용해 고객의 특징을 자동 추출하고, 영화의 특징도 자동 추출해서 이를 바탕으로 고객의 평점을 예측한다.
- 이 방식은 넷플릭스 프라이즈에서 사이먼 펑크라는 가명을 사용한 참가자가 고안했는데, 그는 친구와 함께 뉴질랜드 여행 중에 참가하여 3위까지 올라갔다.
  - 이 방식이 좋은 성과를 내던 어느 날 그는 더 이상 대회에 참가하지 않겠다고 선언하며 2006년에 자신이 발명안 알고리즘을 블로그에 모두 공개한 후 홀연히 떠났다.
- (펑크의) 행렬 인수분해는 고객이 영화에 평점을 매긴 점수 정보를 하나의 큰 행렬로 보고 이를 2개의 다른 행렬로 분해해서 예측 정보를 얻어내는 방식이다.
  - 행렬 인수분해의 결과는 고객 행렬과 영화 행렬의 전치 행렬을 구한 다음 서로 내적을 구하는 식이다.
- 고객과 영화에 대해 특징을 추출하고 값을 정의하는 과정은 평점 정보를 기반으로 모두 자동으로 진행된다.
- 행렬 인수분해는 숨어 있는 특징을 자동으로 추출하므로 이를 두고 `잠재요인(Latent Factors)`을 발국해낸다고 표현한다.
- 특징의 개수를 크게 지정하려면 그만큼 더 많은 데이터가 필요하다. 머신러닝에서는 이를 `차원의 저주(Curse of Dimensionality)` 라고 한다.
  - 특징이 하나 늘어날 때마다 한 차원이 더 추가되는 것이고 그러면 데이터가 훨씬 더 많아야 겨우 비슷한 성능을 낼 수 있다.
  - 그래서 특징의 개수를 늘리는 게 능사는 아니다. 데이터가 부족하면 오히려 제대로 특징을 추출하지 못하고 성능이 더 떨어지는 '저주'가 발생하기 때문

#### 딥러닝을 도입한 유튜브 추천 알고리즘

- 이전에는 유튜브도 행렬 인수분해를 사용했지만 2016년을 전후로 딥러닝 모델을 도입해 더 좋은 추천 성능을 냈다.
- 사용자가 유튜브에서 시청하는 영상 중 70%는 알고리즘이 추천한 영상이니 유튜브의 시청 기록을 학습하면 70% 확률로 추천한 영상을 다시 학습하는 문제가 발생한다. 이 같은 편향을 줄이기 위해 유튜브 밖에서 시청한 이력도 모두 활용했다.
- 유튜브는 초창기에 영상 추천 시 어떤 가치를 극대화할 지 고민을 거듭했다. 사람들이 오래 시청하는 영상을 추천하도록 보상 함수를 개선하고, 이어 보기에도 높은 가중치를 부여했다.
- 유튜브는 신선도를 매우 강조한다. 새로 올라온 영상일수록 고객의 관심이 높기 때문. 그러나 새로운 영상은 영상에 관한 아무런 정보가 없는 `콜드 스타트(Cold Start)` 문제가 있다.
- 추천 시스템은 고객이 기존 취향의 울타리 안에만 갇히지 않도록 노력한다. 이를 `필터 버블(Filter Bubble)`이라 한다.
  - 편견을 강화하지 않기 위해 뜻밖의 발견(Serendipity)은 매우 중요하다. 여기에는 2가지 조건이 충족되어야 한다. 지금까지 본 적 없는 것이지만, 희한하게도 마음에 드는 것이어야 한다.

---

#### Comment

- (p.406-407) 그 유명한 넷플릭스 프라이즈라고 하는데 난 몰랐음. 우승을 위해 협력하여 단일팀이 결성되었고, 결국 그 팀이 우승을 했다는 점도 인상깊다.
  > `넷플릭스 프라이즈(Netflix Prize)`<br/>
  > 넷플릭스는 자사의 추천 알고리즘의 성능을 10% 이상 끌어올리기 위해서 넷플릭스 프라이즈를 열었는데, 무려 100만 달러의 상금을 걸고 2006년부터 개최되었고, 2009년 7월 26일 BellKor's Pragmatic Chaos 팀이 10.06%의 성능을 끌어올리면서 대회가 마무리 되었다.
  - [참고] https://glasslego.tistory.com/190
  - [참고] https://m.dongascience.com/news.php?idx=11089
- 기저귀와 맥주의 상관관계, 10대 소녀 임신 예측 스토리를 여기서 또 보니 반가웠다.
- (p.424-425) 홀연히 떠난 은둔 고수 사이먼 펑크의 정체는 누굴까

---

- 터틀 북클럽의 첫 책을 마쳤다. 일주일에 2개 챕터씩 읽고 정리한다는 게 쉬울 것 같아도 실천은 생각보다 어렵다는 것을 다시 한 번 체감
- AI 관련 소양이 부족하다고 느끼던 시점에 가볍게 시작할 수 있는 책이라 좋았던 한편, 너무 가볍지 않나 하는 생각이 동시에 들었다.
- 앞으로 점차 깊이있게 채워나가면 될 듯. 북클럽 다음 책으로 이 책의 후속 책인 <비전공자도 이해할 수 있는 챗GPT>를 읽기로 했는데, 이러한 부분이 어느정도 해소되기를 기대한다.
